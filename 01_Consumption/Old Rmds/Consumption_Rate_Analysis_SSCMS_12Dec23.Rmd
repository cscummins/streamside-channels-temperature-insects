---
title: "Consumption_Rate_Calculations_SSCMS_10Aug2023"
author: "Carolyn Cummins"
date: "2023-08-10"
output: html_document
---

Set WD and read in packages:
```{r}

setwd("/Users/ccummins/Documents/Dissertation etc./Data/Streamside channels/01_Consumption")

library(ggplot2)
library(scales)
library(tidyverse)
library(lme4)
library(lmerTest)
library(ggsci)
library(ggeffects)

```


Read in consumption rate data
```{r}

CT1 <- read.csv("Consumption_data_CT1_28April21.csv", header=T)
CT1 <- CT1 %>% mutate(date.start=ymd(date.start))
CT1 <- CT1 %>% mutate(date.end=ymd(date.end))

CT2 <- read.csv("Consumption_data_CT2_19May21.csv", header=T)
CT2 <- CT2 %>% filter(!row_number() %in% c(161:248))
CT2 <- CT2 %>% mutate(date.start=dmy(date.start))
CT2 <- CT2 %>% mutate(date.end=dmy(date.end))

CT3 <- read.csv("Consumption_data_CT3_19May21.csv", header=T)
CT3 <- CT3 %>% filter(!row_number() %in% c(161:248))
CT3 <- CT3 %>% mutate(date.start=dmy(date.start))
CT3 <- CT3 %>% mutate(date.end=dmy(date.end))

all_consumption <- read.csv("Consumption_data_all_11Dec2019.csv")
all_consumption <- all_consumption %>% filter(!row_number() %in% c(569:2790))

#will now bind CT1, CT2, and CT3. These have been determined to be identical to the all_consumption data
all_consumption_data <- bind_rows(CT1,CT2,CT3)
all_consumption_data <- all_consumption_data %>% dplyr::rename(trial = trial.)
all_consumption_data <- all_consumption_data %>% dplyr::select(-c(notes))

```


Create blotted:AFDM regression!
```{r}

blot_AFDM_data <- read.csv("Blot_AFDM_reg_29Apr21.csv", header = TRUE)
blot_AFDM_data$blotted_g <- (blot_AFDM_data$boat_blotted_g-blot_AFDM_data$boat_g)
blot_AFDM_data$AFDM_g <- (blot_AFDM_data$tin_DM_g - blot_AFDM_data$tin_ash_g)

blot_AFDM_data_R <- blot_AFDM_data[which(blot_AFDM_data$R.A=="R"),]
blot_AFDM_data_A <- blot_AFDM_data[which(blot_AFDM_data$R.A=="A"),]
blot_AFDM_data_A <- blot_AFDM_data_A[which(blot_AFDM_data_A$blotted_g>0),] #removed one outlier where the blotted weight was negative because this doesn't make sense and was likely a data entry/recording error

#for this regression, force it through the origin.
blot_AFDM_reg_R <- lm(AFDM_g~0+blotted_g, data = blot_AFDM_data_R)
summary(blot_AFDM_reg_R)
#R AFDM = 0.399453(blotted)

blot_AFDM_reg_A <- lm(AFDM_g~0+blotted_g, data = blot_AFDM_data_A)
summary(blot_AFDM_reg_A)
#A AFDM = 0.209441(blotted)

plot_blot_AFDM_R <-ggplot(blot_AFDM_data_R,aes(x=AFDM_g,y=blotted_g))+theme_classic()+
  geom_point()

plot_blot_AFDM_A <-ggplot(blot_AFDM_data_A,aes(x=AFDM_g,y=blotted_g))+theme_classic()+
  geom_point()

```


*Data carpentry to get consumption rates*
```{r}

#Get blotted weights
all_consumption_data <- all_consumption_data %>% mutate(blotted_g = boat.blot.g - boat.g)

all_consumption_data <- na.omit(all_consumption_data) #deleted rows with NA for now

#Get post-consumption AFDM
all_consumption_data <- all_consumption_data %>% filter(blotted_g>0) #omit one observation where blotted weight was negative
all_consumption_data <- all_consumption_data %>% mutate(DM_fp = fp.PCLDM.g-fp.g)
all_consumption_data <- all_consumption_data %>% mutate(DM_tin = tin.dm.g - tin.mass.g) #these seem systematically lower than the FP ones
all_consumption_data <- all_consumption_data %>% mutate(AFDM_end = tin.dm.g-tin.ash.g)

```


Get beginning AFDM based on leaf species-specific blotted:AFDM regressions
R AFDM = 0.399453(blotted)
A AFDM = 0.209441(blotted)
```{r}
all_consumption_data <- all_consumption_data %>% mutate(
  AFDM_beg = case_when(
    species=="A" ~ 0.209441*blotted_g,
    species=="R" ~ 0.399453*blotted_g
  )
)

all_consumption_data <- all_consumption_data %>% mutate(AFDM_beg_mg = AFDM_beg*1000)
all_consumption_data <- all_consumption_data %>% mutate(AFDM_end_mg = AFDM_end*1000)

```


In this chunk:
1. Calculate consumption rates
2. Separate microbes and bugs
3. Get average microbial consumption rate by trial, temperature, and leaf species
4. Bind the microbe consumption averages to the bug data based on trial, temp, and leaf species
5. Subtract microbe consumption averages from bug consumption rates
6. Create new dataframe with average consumption rates 
```{r}

all_consumption_data <- all_consumption_data %>% mutate(consumption.rate.mg.day = ((AFDM_beg_mg-AFDM_end_mg)/days))
consumption_microbes <- all_consumption_data %>% filter(type=="microbes")
consumption_bugs <- all_consumption_data %>% filter(type=="bug")

microbial_consumption_averages <- consumption_microbes %>%
  group_by(trial, treatment, species) %>%
  dplyr::summarise(mean_microbe_consumption = mean(consumption.rate.mg.day, na.rm = T)) %>% ungroup()

consumption_bugs_microbes <- left_join(consumption_bugs, microbial_consumption_averages)
consumption_bugs_microbes <- consumption_bugs_microbes %>% mutate(consumption_bug_mg_day.corr=consumption.rate.mg.day-mean_microbe_consumption)

```


Read in the temperature data averaged at the flume level, bind with the consumption_bugs_microbes dataframe
```{r}

channel_temp_weekly_averages_1 <- read.csv("all_flume_temp_expt_averages_1.csv")
channel_temp_weekly_averages_1$week <- as.character(channel_temp_weekly_averages_1$week)
channel_temp_weekly_averages_2 <- read.csv("all_flume_temp_expt_averages_2.csv")
channel_temp_weekly_averages_2 <- channel_temp_weekly_averages_2 %>% filter(week %in% c("1b","3b"))
channel_temp_weekly_averages_3 <- read.csv("all_flume_temp_expt_averages_3.csv")
channel_temp_weekly_averages_3 <- channel_temp_weekly_averages_3 %>% filter(week %in% c("1c","3c"))

channel_temp_weekly_averages <- bind_rows(channel_temp_weekly_averages_1,channel_temp_weekly_averages_2, channel_temp_weekly_averages_3)


consumption_bugs_microbes <- consumption_bugs_microbes %>% mutate(
  week = case_when(
    date.start=='2019-03-12' & date.end=='2019-03-20' ~ '1',
    date.start=='2019-03-12' & date.end=='2019-03-21' ~ '1b',
    date.start=='2019-03-13' & date.end=='2019-03-21' ~ '1c',
    date.start=='2019-03-27' & date.end=='2019-04-03' ~ '3',
    date.start=='2019-03-28' & date.end=='2019-04-03' ~ '3b',
    date.start=='2019-03-28' & date.end=='2019-04-04' ~ '3c',
    date.start=='2019-04-10' & date.end=='2019-04-17' ~ '5',
      )
)

consumption_rate_weekly_temps <- left_join(consumption_bugs_microbes, channel_temp_weekly_averages)
consumption_rate_weekly_temps$species = as.factor(consumption_rate_weekly_temps$species)

consumption_rate_weekly_temps_R <- consumption_rate_weekly_temps %>% filter(species=="R")
consumption_rate_weekly_temps_A <- consumption_rate_weekly_temps %>% filter(species=="A")

mean(consumption_rate_weekly_temps_R$blotted_g)
mean(consumption_rate_weekly_temps_A$blotted_g)


```


Correct consumption rates by average body mass during trial

Read in data with beginning and ending masses for each bug
```{r}

bug.beginning.masses <- read.csv("begin.lengths.masses.csv")
colnames(bug.beginning.masses)[colnames(bug.beginning.masses)=="Temp.TRT"]<-"treatment"
colnames(bug.beginning.masses)[colnames(bug.beginning.masses)=="Channel"]<-"channel"
colnames(bug.beginning.masses)[colnames(bug.beginning.masses)=="Leaf.spp."]<-"species"
colnames(bug.beginning.masses)[colnames(bug.beginning.masses)=="Chamber"]<-"chamber"
colnames(bug.beginning.masses)[colnames(bug.beginning.masses)=="Beg.Length.mm"]<-"beg.length.mm"

bug.beginning.masses <- bug.beginning.masses %>% select(treatment, channel, chamber, species, beg.length.mm, beg.mass.mg)

```


Join the beginning lengths and masses to the consumption data, calculate consumption rate per beginning mass (mg)
```{r}
bug.beginning.masses$treatment <- as.integer(bug.beginning.masses$treatment)
bug.beginning.masses$species <- as.factor(bug.beginning.masses$species)
bug.beginning.masses$beg.length.mm <- as.numeric(bug.beginning.masses$beg.length.mm)
bug.beginning.masses$beg.mass.mg <- as.numeric(bug.beginning.masses$beg.mass.mg)

consumption_rate_weekly_temps_l.m <- left_join(consumption_rate_weekly_temps, bug.beginning.masses)

consumption_rate_weekly_temps_l.m <- consumption_rate_weekly_temps_l.m %>%
  mutate(consumption_bug_mg_day_corr.mass=consumption_bug_mg_day.corr/beg.mass.mg)

```


Correct consumption rates for the average bug mass during the trial according to our global mean IGR
end mass = beginning mass[exp(IGR*days)]
Figure out the days for the start and end of each trial
```{r}
mean_igr_all <- 0.002452633
ssc_photos_beg <- read.csv("SSC2019.photos.beg.csv")
begin_date <- ssc_photos_beg %>% select(Chamber, Beg.Date)

colnames(begin_date)[colnames(begin_date)=="Chamber"]<-"chamber"
colnames(begin_date)[colnames(begin_date)=="Beg.Date"]<-"expt_begin_date"

begin_date <- begin_date %>% mutate(expt_begin_date=dmy(expt_begin_date))

consumption_rate_weekly_temps_l.m <- left_join(consumption_rate_weekly_temps_l.m, begin_date)

consumption_rate_weekly_temps_l.m <- consumption_rate_weekly_temps_l.m %>% 
  mutate(days_since_beg_trial_start=as.numeric(date.start-expt_begin_date)) %>% 
  mutate(days_since_beg_trial_end=as.numeric(date.end-expt_begin_date))

consumption_rate_weekly_temps_l.m <- consumption_rate_weekly_temps_l.m %>% 
  mutate(bug_modeled_mass_trial_start=beg.mass.mg*(exp(mean_igr_all*days_since_beg_trial_start))) %>% 
  mutate(bug_modeled_mass_trial_end=beg.mass.mg*(exp(mean_igr_all*days_since_beg_trial_end)))

consumption_rate_weekly_temps_l.m <- consumption_rate_weekly_temps_l.m %>% 
  mutate(mean_modeled_bug_mass_trial=((bug_modeled_mass_trial_start + bug_modeled_mass_trial_end)/2))

consumption_rate_weekly_temps_l.m <- consumption_rate_weekly_temps_l.m %>%
  mutate(consumption_bug_mg_day_corr.modeled.mass=consumption_bug_mg_day.corr/mean_modeled_bug_mass_trial)

```



**Models for consumption rate corrected for beginning mass**
Model with a leaf species interaction
*THIS IS THE MODEL I THINK WE SHOULD GO WITH*
```{r}

lmer_indiv_consumption.masscorr <- lmer(consumption_bug_mg_day_corr.mass~mean_temp_C*species + (1|trial), data=consumption_rate_weekly_temps_l.m)
summary(lmer_indiv_consumption.masscorr)
#Acer: parameter estimate = -0.02, p=0.09 (marginally significant)
#Rhodo: parameter estimate = 0.06, p=0.000165
#intercept is significantly higher for Acer than Rhodo
#slope is significantly higher for Rhodo than Acer

#Run this line to see the other level of the factor as the default in the model
consumption_rate_weekly_temps_l.m$species <- factor(consumption_rate_weekly_temps_l.m$species, levels=rev(levels(consumption_rate_weekly_temps_l.m$species)))

```


Split corrected consumption rate data into R and A, model each leaf species separately as a function of temperature
```{r}

consumption_rate_weekly_temps_l.m.R <- consumption_rate_weekly_temps_l.m %>% filter(species=="R")
consumption_rate_weekly_temps_l.m.A <- consumption_rate_weekly_temps_l.m %>% filter(species=="A")


rhodo_consumption_model.corr <- lmer(consumption_bug_mg_day_corr.mass ~ mean_temp_C + (1|trial), data=consumption_rate_weekly_temps_l.m.R)
summary(rhodo_consumption_model.corr)
#Parameter estimate = 0.04, p=0.05
pred.rhodo.consumption.corr <- ggpredict(rhodo_consumption_model.corr, terms="mean_temp_C")


acer_consumption_model.corr <- lmer(consumption_bug_mg_day_corr.mass ~ mean_temp_C + (1|trial), data=consumption_rate_weekly_temps_l.m.A)
summary(acer_consumption_model.corr)
#Parameter estimate = -0.015, p=0.16
pred.acer.consumption.corr <- ggpredict(acer_consumption_model.corr, terms="mean_temp_C")

```

Create ggpredict dataframe for both leaf spp.
```{r}

pred.rhodo.consumption.corr$species <- "R"
pred.acer.consumption.corr$species <- "A"
pred.r.a.consumption.corr <- rbind(pred.rhodo.consumption.corr, pred.acer.consumption.corr)

```



```{r}
pal.consumption <- c("#3F4788FF", "#FEB72DFF")

consumption_temp_plot_ggpredict.corr <- ggplot(consumption_rate_weekly_temps_l.m)+
  geom_point(data=consumption_rate_weekly_temps_l.m, aes(x=mean_temp_C, y = consumption_bug_mg_day_corr.mass, color=species, shape=trial))+
  geom_line(data=pred.r.a.consumption.corr, aes(x=x, y=predicted, color=species))+
  geom_ribbon(data=pred.r.a.consumption.corr, aes(x = x, ymin = conf.low, ymax = conf.high, fill=species), alpha = 0.25, show.legend=F)+
  theme_classic()+
  theme(legend.title=element_blank())+
  xlab("Mean temperature (°C)")+
  ylab(expression(atop(paste("Mass-specific consumption rate"), "(mg mg"^-1*" d"^-1*")")))+
  theme(legend.text=element_text(size=14))+
  theme(axis.title=element_text(size=14))+
  theme(axis.text=element_text(size=12, face="bold"))+
  scale_color_manual(values = pal.consumption, 
                     labels=c(expression(paste(italic("Rhododendron"))), expression(paste(italic("Acer")))))+
  scale_fill_manual(values=c("#FEB72DFF", "#3F4788FF"))+
  theme(legend.text.align=0)+
  scale_shape_manual(values=c(16,17,15), labels=c("Trial 1", "Trial 2", "Trial 3"))+
  scale_x_continuous(breaks=c(9,10,11,12,13,14,15,16,17,18))

consumption_temp_plot_ggpredict.corr


```


```{r}

#jpeg(filename="mass.spec.consumption_temp_plot.jpeg", width=22, height=12, units="cm", pointsize=12, bg="white", res=600)
#consumption_temp_plot_ggpredict.corr
#dev.off()

```


Consumption vs. temperature in trial 1 and trial 3 to try and contextualize the FB data

Trial 1
```{r}

consumption_rate_weekly_temps_l.m.CT1 <- consumption_rate_weekly_temps_l.m %>% filter(trial=="CT1")

#Linear model -- use temperature treatment instead of mean temperature
lm_indiv_consumption.masscorr.CT1 <- lm(consumption_bug_mg_day_corr.mass~mean_temp_C*species, data=consumption_rate_weekly_temps_l.m.CT1)
summary(lm_indiv_consumption.masscorr.CT1)

#reverse levels to examine other leaf species rel with temp
consumption_rate_weekly_temps_l.m.CT1$species <- factor(consumption_rate_weekly_temps_l.m.CT1$species,
                                                        levels=rev(levels(consumption_rate_weekly_temps_l.m.CT1$species)))
#marginally significant, positive effect of temperature treatment on Rhodo consumption (parameter estimate = 0.02, p=0.07)
#Intercept for rhodo consumption is lower, but not significant
#nonsignificant, slightly positive effect of temperature on acer consumption (est. = 0.0103, p = 0.464)
#model states that there is no significant difference in slopes by leaf type in trial 1

```

Graph for Trial 1
```{r}

consumption_temp_plot.CT1 <- ggplot(consumption_rate_weekly_temps_l.m.CT1, aes(x=mean_temp_C, y=consumption_bug_mg_day_corr.mass))+
  geom_smooth(data = subset(consumption_rate_weekly_temps_l.m.CT1, species=="R"), method="lm", color="#3F4788FF")+ 
  geom_point(data=consumption_rate_weekly_temps_l.m.CT1, 
             aes(x=mean_temp_C, y = consumption_bug_mg_day_corr.mass, color=species))+
  theme_classic()+
  theme(legend.title=element_blank())+
  xlab("Mean temperature (°C)")+
  ylab(expression(atop(paste("Mass-specific consumption rate"), "(mg mg"^-1*" d"^-1*")")))+
  theme(legend.text=element_text(size=14))+
  theme(axis.title=element_text(size=14))+
  theme(axis.text=element_text(size=12, face="bold"))+
  scale_color_manual(values = pal.consumption, 
                     labels=c(expression(paste(italic("Rhododendron"))), expression(paste(italic("Acer")))))+
  theme(legend.text.align=0)#+
  #scale_x_continuous(breaks=c(0,1,2,3,4), labels=c("+0°C", "+1°C", "+2°C", "+3°C", "+4°C"))

consumption_temp_plot.CT1


```



Trial 3
```{r}

consumption_rate_weekly_temps_l.m.CT3 <- consumption_rate_weekly_temps_l.m %>% filter(trial=="CT3")

#Linear model -- use temperature treatment instead of mean temperature
lm_indiv_consumption.masscorr.CT3 <- lm(consumption_bug_mg_day_corr.mass~treatment*species, data=consumption_rate_weekly_temps_l.m.CT3)
summary(lm_indiv_consumption.masscorr.CT3)

#reverse levels to examine other leaf species rel with temp
consumption_rate_weekly_temps_l.m.CT3$species <- factor(consumption_rate_weekly_temps_l.m.CT3$species,
                                                        levels=rev(levels(consumption_rate_weekly_temps_l.m.CT3$species)))
#nonsignificant, positive effect of temperature treatment on Acer consumption (parameter estimate = 0.004, p=0.89)
#Intercept for acer consumption is significantly lower
#nonsignificant, slightly negative effect of temperature on rhodo consumption (est. = -0.01811, p=0.532)
#model states that there is no significant difference in slopes by leaf type in trial 3


```


Graph for Trial 3
```{r}

consumption_temp_plot.CT3 <- ggplot(consumption_rate_weekly_temps_l.m.CT3, aes(x=mean_temp_C, y=consumption_bug_mg_day_corr.mass))+
  geom_point(data=consumption_rate_weekly_temps_l.m.CT3, 
             aes(x=mean_temp_C, y = consumption_bug_mg_day_corr.mass, color=species))+
  theme_classic()+
  theme(legend.title=element_blank())+
  xlab("Mean temperature (°C)")+
  ylab(expression(atop(paste("Mass-specific consumption rate"), "(mg mg"^-1*" d"^-1*")")))+
  theme(legend.text=element_text(size=14))+
  theme(axis.title=element_text(size=14))+
  theme(axis.text=element_text(size=12, face="bold"))+
  scale_color_manual(values = pal.consumption, 
                     labels=c(expression(paste(italic("Rhododendron"))), expression(paste(italic("Acer")))))+
  theme(legend.text.align=0)#+
  #scale_x_continuous(breaks=c(0,1,2,3,4), labels=c("+0°C", "+1°C", "+2°C", "+3°C", "+4°C"))

consumption_temp_plot.CT3


```


Write a .csv with consumption rates that will eventually get joined with growth and development
```{r}

consumption_rate_to.join <- consumption_rate_weekly_temps_l.m %>% select(trial, date.start, date.end, days, treatment, channel, chamber, species, mean_temp_C, AFDM_beg_mg, AFDM_end_mg, consumption.rate.mg.day, mean_microbe_consumption, consumption_bug_mg_day.corr, consumption_bug_mg_day_corr.mass, consumption_bug_mg_day_corr.modeled.mass)

#write.csv(consumption_rate_to.join, "consumption_rate_to.join.csv")
#last written and updated to synthesis folder 28 Mar 2024

```


##################################

Ash fraction for microbe samples
```{r}

consumption_microbes <- consumption_microbes %>% mutate(ash_fraction=(1-(AFDM_end/DM_tin)))
consumption_microbes_A <- consumption_microbes %>% filter(species=="A")
consumption_microbes_R <- consumption_microbes %>% filter(species=="R")

mean_ash_fraction_A <- mean(consumption_microbes_A$ash_fraction)
#0.18979

mean_ash_fraction_R <- mean(consumption_microbes_R$ash_fraction)
#0.09529

```





**Models for consumption rate corrected for modeled trial mass**
Model with a leaf species interaction
*THIS IS THE MODEL I THINK WE SHOULD GO WITH*
```{r}

lmer_indiv_consumption_modeled.masscorr <- lmer(consumption_bug_mg_day_corr.modeled.mass~mean_temp_C*species + (1|trial), data=consumption_rate_weekly_temps_l.m)
summary(lmer_indiv_consumption_modeled.masscorr)
#Acer: parameter estimate = -0.016, p=0.10 (not significant)
#Rhodo: parameter estimate = 0.038, p=0.000231
#intercept is significantly higher for Acer than Rhodo
#slope is significantly higher for Rhodo than Acer

#Run this line to see the other level of the factor as the default in the model
consumption_rate_weekly_temps_l.m$species <- factor(consumption_rate_weekly_temps_l.m$species, levels=rev(levels(consumption_rate_weekly_temps_l.m$species)))

```


Split corrected consumption rate data into R and A, model each leaf species separately as a function of temperature
```{r}

rhodo_consumption_model.modeled.mass.corr <- lmer(consumption_bug_mg_day_corr.modeled.mass ~ mean_temp_C + (1|trial), data=consumption_rate_weekly_temps_l.m.R)
summary(rhodo_consumption_model.modeled.mass.corr)
#Parameter estimate = 0.03, p=0.05
pred.rhodo.consumption.modeled.mass.corr <- ggpredict(rhodo_consumption_model.modeled.mass.corr, terms="mean_temp_C")


acer_consumption_model.modeled.mass.corr <- lmer(consumption_bug_mg_day_corr.modeled.mass ~ mean_temp_C + (1|trial), data=consumption_rate_weekly_temps_l.m.A)
summary(acer_consumption_model.modeled.mass.corr)
#Parameter estimate = -0.01, p=0.17
pred.acer.consumption.modeled.mass.corr <- ggpredict(acer_consumption_model.modeled.mass.corr, terms="mean_temp_C")

```


Create ggpredict dataframe for both leaf spp.
```{r}

pred.rhodo.consumption.modeled.mass.corr$species <- "R"
pred.acer.consumption.modeled.mass.corr$species <- "A"
pred.r.a.consumption.modeled.mass.corr <- rbind(pred.rhodo.consumption.modeled.mass.corr, pred.acer.consumption.modeled.mass.corr)

```


Plot with all the datapoints, line and ribbon for Rhodo only - modeled mass-corrected consumption rates
```{r}
pal.consumption <- c("#FEB72DFF", "#3F4788FF")

consumption_temp_plot_ggpredict.modeled.mass.corr <- ggplot(pred.rhodo.consumption.modeled.mass.corr)+
  geom_ribbon(aes(x = x, ymin = conf.low, ymax = conf.high), alpha = 0.25, fill="#3F4788FF")+
  geom_line(color="#3F4788FF", aes(x=x, y=predicted))+
  geom_point(data=consumption_rate_weekly_temps_l.m, 
             aes(x=mean_temp_C, y = consumption_bug_mg_day_corr.modeled.mass, color=species, shape=as.factor(trial)))+
  theme_classic()+
  theme(legend.title=element_blank())+
  xlab("Mean temperature (°C)")+
  ylab(expression(atop(paste("Mass-specific consumption rate"), "(mg mg"^-1*" d"^-1*")")))+
  theme(legend.text=element_text(size=14))+
  theme(axis.title=element_text(size=14))+
  theme(axis.text=element_text(size=12, face="bold"))+
  scale_color_manual(values = pal.consumption, 
                     labels=c(expression(paste(italic("Acer"))), expression(paste(italic("Rhododendron")))))+
  theme(legend.text.align=0)+
  scale_shape_manual(values=c(16,17,15), labels=c("Trial 1", "Trial 2", "Trial 3"))+
  scale_x_continuous(breaks=c(9,10,11,12,13,14,15,16,17,18))

consumption_temp_plot_ggpredict.modeled.mass.corr
```


```{r}
jpeg(filename="mod.mass.spec.consumption_temp_plot.jpeg", width=22, height=12, units="cm", pointsize=12, bg="white", res=600)
consumption_temp_plot_ggpredict.modeled.mass.corr
dev.off()
```

